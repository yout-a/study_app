<!-- app/views/words/index.html.erb -->
<% content_for :title, "ÂçòË™û‰∏ÄË¶ß" %>
<header class="hdr">
  <div class="wrap nav">
    <div class="logo">üìö ÂçòË™û‰∏ÄË¶ß</div>
    <nav class="links">
      <%= link_to "„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ", authenticated_root_path %>
      <%= link_to "Êñ∞Ë¶èÁôªÈå≤", new_word_path %>
      <%= link_to "„É≠„Ç∞„Ç¢„Ç¶„Éà", destroy_user_session_path, data: { turbo_method: :delete } %>
    </nav>
  </div>
</header>

<main class="wrap">
  <%= form_with url: words_path, method: :get, class: "search", local: true do %>
    <input type="text" name="q" value="<%= h(@q) %>" placeholder="ÂçòË™û„ÉªÊÑèÂë≥„Éª„Çø„Ç∞„ÅßÊ§úÁ¥¢‚Ä¶">
    <button class="btn">Ê§úÁ¥¢</button>
  <% end %>

  <section class="card">
    <table class="tbl">
      <thead>
        <tr><th>ÂçòË™û</th><th>ÊÑèÂë≥ÔºàË¶ÅÁ¥ÑÔºâ</th><th>„Çø„Ç∞</th><th></th></tr>
      </thead>
      <tbody>
        <% @words.each do |word| %>
          <tr>
            <td><%= word.term %></td>
            <td><%= truncate(word.meaning, length: 40) %></td>
            <td>
              <% word.tags.each do |t| %>
                <span class="tag"><%= t.name %></span>
              <% end %>
            </td>
            <td class="act">
              <%= link_to "Á∑®ÈõÜ", edit_word_path(word) %> /
              <%= link_to "ÂâäÈô§", word_path(word), data: { turbo_method: :delete, turbo_confirm: "ÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü" } %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>

    <!-- Á∞°Êòì„Éö„Éº„Ç∏„É≥„Ç∞ -->
    <% per = 20; total_pages = (@total.to_f / per).ceil %>
    <% if total_pages > 1 %>
      <div class="actions" style="justify-content:flex-end">
        <% (1..total_pages).each do |p| %>
          <% if p == @page %>
            <span class="btn primary"><%= p %></span>
          <% else %>
            <%= link_to p, words_path(q: @q, page: p), class: "btn" %>
          <% end %>
        <% end %>
      </div>
    <% end %>
  </section>
</main>
